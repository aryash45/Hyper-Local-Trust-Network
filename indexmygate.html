<!DOCTYPE html>
<!-- Set initial theme to light and enable smooth scrolling -->
<html lang="en" class="light scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Web App</title>
    
    <!-- Tailwind CSS & Phosphor Icons CDNs -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- Tailwind Dark Mode Configuration -->
    <script>
        tailwind.config = {
            darkMode: 'class', // Enable dark mode based on a class
        }
    </script>

    <!-- Custom Styles & Animations -->
    <style>
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 5px; }
        .dark ::-webkit-scrollbar-track { background: #2d3748; }
        .dark ::-webkit-scrollbar-thumb { background: #6b7280; }

        /* Active tab indicator */
        .tab-active {
            border-bottom-color: #3b82f6; /* blue-500 */
            color: #3b82f6;
            font-weight: 600;
        }
        .dark .tab-active {
            border-bottom-color: #60a5fa; /* blue-400 */
            color: #60a5fa;
        }
        /* Active nav link style */
        .nav-active {
            color: #3b82f6; /* blue-500 */
        }
        .dark .nav-active { color: #60a5fa; }

        /* Detail View slide-in transition */
        #detail-view { transition: transform 0.3s ease-in-out; }
        #detail-view.show { transform: translateX(0%); }

        /* Profile Drawer slide-in transition */
        #profile-drawer { transition: transform 0.3s ease-in-out; }
        #profile-drawer.show { transform: translateX(0%); }

        /* Overlay fade-in transition */
        .overlay { transition: opacity 0.3s ease-in-out; }

        /* Pull-to-refresh indicator transition */
        #pull-to-refresh-indicator { transition: transform 0.3s ease, opacity 0.3s ease; }

        /* Skeleton loading animation */
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        .skeleton {
            animation: shimmer 2s infinite linear;
            background: linear-gradient(to right, transparent 0%, #e5e7eb 50%, transparent 100%);
            background-size: 2000px 100%;
        }
        .dark .skeleton {
            background: linear-gradient(to right, transparent 0%, #4a5568 50%, transparent 100%);
            background-size: 2000px 100%;
        }

        /* SOS pulse animation */
        @keyframes pulse-red {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(239, 68, 68, 0);
            }
        }
        .sos-pulse {
            animation: pulse-red 2s infinite;
        }

        /* Security score animation */
        @keyframes security-score-draw {
            from { stroke-dashoffset: 100; }
            to { stroke-dashoffset: 25; } /* 100 - 75 (score) */
        }
        .security-score-circle {
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            animation: security-score-draw 1.5s 0.5s ease-out forwards;
        }

        /* Marketplace favorite button animation */
        .favorite-btn.favorited .ph-heart-fill {
            animation: heart-pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes heart-pop {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900">

    <!-- Main container to simulate a mobile view on desktop -->
    <div id="app-container" class="max-w-lg mx-auto bg-white dark:bg-gray-800 min-h-screen font-sans relative pb-24 overflow-x-hidden">

        <!-- Pull-to-Refresh Indicator -->
        <div id="pull-to-refresh-indicator" class="absolute top-0 left-0 right-0 flex justify-center items-center pt-4 pb-2 text-gray-500 dark:text-gray-400 opacity-0 z-10">
            <i class="ph ph-arrow-clockwise text-2xl transition-transform duration-300"></i>
        </div>

        <!-- Main Scrollable Area -->
        <div id="main-scroll-area" class="h-screen overflow-y-auto">
            <!-- Header with Search and Actions -->
            <header class="p-4 flex items-center justify-between sticky top-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm z-20 border-b border-gray-100 dark:border-gray-700">
                <div class="relative flex-grow">
                    <i class="ph ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"></i>
                    <input type="text" id="search-bar" placeholder="Search..." class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 w-full rounded-full py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-400">
                </div>
                <button id="dark-mode-toggle" class="ml-4 text-gray-600 dark:text-gray-300">
                    <i class="ph ph-moon text-2xl"></i>
                </button>
                <button id="profile-drawer-btn" class="ml-4 text-gray-600 dark:text-gray-300">
                    <i class="ph ph-user-circle text-3xl"></i>
                </button>
            </header>

            <!-- Main content -->
            <main class="p-4 space-y-6">
                <!-- Ad Card -->
                <section class="relative rounded-xl overflow-hidden shadow-lg">
                    <img src="https://placehold.co/600x300/e2e8f0/334155?text=Special+Offer" alt="Advertisement" class="w-full h-40 object-cover">
                    <div class="absolute bottom-0 left-0 p-4 bg-gradient-to-t from-black/60 to-transparent w-full">
                        <h2 class="text-white font-bold text-lg">Upgrade Your Plan</h2>
                        <p class="text-white text-sm">Get 50% off on your next upgrade.</p>
                    </div>
                </section>

                <!-- Quick Actions -->
                <section>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-4 text-lg">Quick Actions</h3>
                    <div class="grid grid-cols-4 gap-4 text-center">
                        <div class="quick-action-item cursor-pointer" data-action="helpdesk">
                            <div class="bg-blue-100 dark:bg-blue-900/50 text-blue-500 dark:text-blue-400 p-3 rounded-xl inline-block"><i class="ph ph-question text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Helpdesk</span>
                        </div>
                        <div class="quick-action-item cursor-pointer" data-action="entries">
                            <div class="bg-green-100 dark:bg-green-900/50 text-green-500 dark:text-green-400 p-3 rounded-xl inline-block"><i class="ph ph-calendar-plus text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Future Entries</span>
                        </div>
                        <div class="quick-action-item cursor-pointer" data-action="scan">
                            <div class="bg-purple-100 dark:bg-purple-900/50 text-purple-500 dark:text-purple-400 p-3 rounded-xl inline-block"><i class="ph ph-qr-code text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Scan QR</span>
                        </div>
                        <div class="quick-action-item relative cursor-pointer" data-action="customize">
                            <div class="bg-yellow-100 dark:bg-yellow-900/50 text-yellow-500 dark:text-yellow-400 p-3 rounded-xl inline-block"><i class="ph ph-swatches text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Customize</span>
                            <span class="absolute top-0 right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white">3</span>
                        </div>
                        <!-- New Quick Actions -->
                        <div class="quick-action-item cursor-pointer" data-action="services">
                            <div class="bg-teal-100 dark:bg-teal-900/50 text-teal-500 dark:text-teal-400 p-3 rounded-xl inline-block"><i class="ph ph-wrench text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Services</span>
                        </div>
                        <div class="quick-action-item cursor-pointer" data-action="sos">
                            <div class="bg-red-100 dark:bg-red-900/50 text-red-500 dark:text-red-400 p-3 rounded-xl inline-block"><i class="ph ph-siren text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">SOS</span>
                        </div>
                        <div class="quick-action-item cursor-pointer" data-action="clubhouse">
                            <div class="bg-orange-100 dark:bg-orange-900/50 text-orange-500 dark:text-orange-400 p-3 rounded-xl inline-block"><i class="ph ph-game-controller text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Clubhouse</span>
                        </div>
                        <div class="quick-action-item cursor-pointer" data-action="delivery">
                            <div class="bg-lime-100 dark:bg-lime-900/50 text-lime-500 dark:text-lime-400 p-3 rounded-xl inline-block"><i class="ph ph-package text-2xl"></i></div>
                            <span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Delivery</span>
                        </div>
                    </div>
                </section>

                <!-- Announcements Banner -->
                <section class="bg-indigo-50 dark:bg-indigo-900/30 rounded-xl p-4 flex items-center justify-between shadow">
                    <div>
                        <h4 class="font-bold text-indigo-800 dark:text-indigo-300">New Features!</h4>
                        <p class="text-sm text-indigo-600 dark:text-indigo-400">Check out the latest community updates.</p>
                    </div>
                    <button class="bg-indigo-500 text-white text-sm font-semibold px-4 py-2 rounded-lg">Explore</button>
                </section>

                <!-- Trending Services -->
                <section>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-3 text-lg">Trending Services</h3>
                    <div class="flex space-x-4 overflow-x-auto pb-4 -mb-4">
                        <div class="flex-shrink-0 w-40 bg-white dark:bg-gray-700 rounded-xl p-4 shadow-sm text-center cursor-pointer hover:shadow-md transition-shadow">
                            <div class="bg-red-100 dark:bg-red-900/50 text-red-500 dark:text-red-400 p-3 rounded-xl inline-block"><i class="ph ph-paint-brush text-2xl"></i></div>
                            <h4 class="font-semibold mt-2 text-sm text-gray-800 dark:text-gray-200">Home Painting</h4>
                            <p class="text-xs text-gray-500 dark:text-gray-400">Top Rated</p>
                        </div>
                        <div class="flex-shrink-0 w-40 bg-white dark:bg-gray-700 rounded-xl p-4 shadow-sm text-center cursor-pointer hover:shadow-md transition-shadow">
                            <div class="bg-teal-100 dark:bg-teal-900/50 text-teal-500 dark:text-teal-400 p-3 rounded-xl inline-block"><i class="ph ph-plugs-connected text-2xl"></i></div>
                            <h4 class="font-semibold mt-2 text-sm text-gray-800 dark:text-gray-200">Electrician</h4>
                            <p class="text-xs text-gray-500 dark:text-gray-400">24/7 Available</p>
                        </div>
                        <div class="flex-shrink-0 w-40 bg-white dark:bg-gray-700 rounded-xl p-4 shadow-sm text-center cursor-pointer hover:shadow-md transition-shadow">
                            <div class="bg-sky-100 dark:bg-sky-900/50 text-sky-500 dark:text-sky-400 p-3 rounded-xl inline-block"><i class="ph ph-faucet text-2xl"></i></div>
                            <h4 class="font-semibold mt-2 text-sm text-gray-800 dark:text-gray-200">Plumbing</h4>
                            <p class="text-xs text-gray-500 dark:text-gray-400">Fast Service</p>
                        </div>
                    </div>
                </section>

                <!-- Updates Section -->
                <section>
                    <div class="flex border-b border-gray-200 dark:border-gray-700 mb-4">
                        <button id="tab-visitor" class="flex-1 py-2 text-center font-semibold text-gray-500 dark:text-gray-400 border-b-2 border-transparent transition-colors duration-300 tab-active">Visitor Updates</button>
                        <button id="tab-community" class="flex-1 py-2 text-center font-semibold text-gray-500 dark:text-gray-400 border-b-2 border-transparent transition-colors duration-300">Community Posts</button>
                    </div>
                    <div id="visitor-updates-content" class="space-y-4"></div>
                    <div id="community-posts-content" class="hidden space-y-4"></div>
                </section>
            </main>
        </div>

        <!-- Payments Page -->
        <div id="payments-page" class="hidden h-screen overflow-y-auto">
            <header class="p-4 flex items-center justify-between sticky top-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm z-20 border-b border-gray-100 dark:border-gray-700">
                <h2 class="text-lg font-bold text-gray-800 dark:text-gray-200 mx-auto">Payments</h2>
            </header>
            <main class="p-4 space-y-8">
                <!-- Dues Summary Card -->
                <section class="bg-gradient-to-br from-blue-500 to-indigo-600 dark:from-blue-600 dark:to-indigo-700 text-white rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm opacity-80">Total Outstanding Dues</span>
                        <i class="ph ph-arrows-clockwise cursor-pointer hover:animate-spin"></i>
                    </div>
                    <p class="text-4xl font-bold mb-4">â‚¹1,800</p>
                    <button class="w-full bg-white/20 backdrop-blur-sm font-semibold py-3 rounded-xl hover:bg-white/30 transition-all">
                        Pay All Dues
                    </button>
                </section>

                <section>
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-gray-800 dark:text-gray-200 text-lg">History</h3>
                        <div class="flex space-x-2 text-sm bg-gray-100 dark:bg-gray-700 p-1 rounded-lg">
                            <button class="payment-filter-btn px-3 py-1 rounded-md" data-filter="all">All</button>
                            <button class="payment-filter-btn px-3 py-1 rounded-md" data-filter="due">Dues</button>
                            <button class="payment-filter-btn px-3 py-1 rounded-md" data-filter="paid">Paid</button>
                        </div>
                    </div>
                    <div id="payments-content" class="space-y-4">
                        <!-- Payment cards will be injected here -->
                    </div>
                </section>
            </main>
        </div>

        <!-- Security Page -->
        <div id="security-page" class="hidden h-screen overflow-y-auto">
            <header class="p-4 flex items-center justify-between sticky top-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm z-20 border-b border-gray-100 dark:border-gray-700">
                <h2 class="text-lg font-bold text-gray-800 dark:text-gray-200 mx-auto">Security</h2>
            </header>
            <main class="p-4 space-y-8">
                <!-- Security Score Card -->
                <section class="bg-white dark:bg-gray-700 rounded-2xl p-6 shadow-lg flex items-center space-x-6">
                    <div class="relative w-24 h-24">
                        <svg class="w-full h-full" viewBox="0 0 36 36">
                            <path class="text-gray-200 dark:text-gray-600" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3"></path>
                            <path id="security-score-circle" class="text-green-500" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="100, 100" stroke-linecap="round"></path>
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-2xl font-bold text-gray-800 dark:text-gray-200">75%</span>
                            <span class="text-xs text-gray-500 dark:text-gray-400">Secure</span>
                        </div>
                    </div>
                    <div class="flex-1">
                        <h3 class="font-bold text-lg text-gray-800 dark:text-gray-200">Security Score: Good</h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">Enable Two-Factor Auth to improve your score.</p>
                        <button class="mt-3 text-sm font-semibold text-blue-500 hover:underline dark:text-blue-400">Improve Score</button>
                    </div>
                </section>

                <section>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-3 text-lg">Connected Devices</h3>
                    <div id="connected-devices-content" class="space-y-3">
                        <!-- Connected devices will be injected here -->
                    </div>
                </section>

                <section>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-3 text-lg">Settings</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-white dark:bg-gray-700 rounded-xl p-4 flex justify-between items-start">
                            <div><h4 class="font-semibold text-gray-800 dark:text-gray-200">App Lock</h4><p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Secure app with biometrics.</p></div>
                            <label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" value="" class="sr-only peer" checked><div class="w-11 h-6 bg-gray-200 dark:bg-gray-600 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div></label>
                        </div>
                        <div class="bg-white dark:bg-gray-700 rounded-xl p-4 flex justify-between items-start">
                            <div><h4 class="font-semibold text-gray-800 dark:text-gray-200">Two-Factor Auth</h4><p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Add an extra layer of security.</p></div>
                            <label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" value="" class="sr-only peer"><div class="w-11 h-6 bg-gray-200 dark:bg-gray-600 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div></label>
                        </div>
                    </div>
                </section>
                <section>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-3 text-lg">Security Logs</h3>
                    <div id="security-content" class="space-y-4">
                        <!-- Security logs will be injected here -->
                    </div>
                </section>
            </main>
        </div>

        <!-- Marketplace Page -->
        <div id="marketplace-page" class="hidden h-screen overflow-y-auto">
            <header class="p-4 flex items-center justify-between sticky top-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm z-20 border-b border-gray-100 dark:border-gray-700">
                <h2 class="text-lg font-bold text-gray-800 dark:text-gray-200 mx-auto">Marketplace</h2>
            </header>
            <main class="p-4 space-y-6">
                <!-- Featured Items -->
                <section>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-3 text-lg">Featured Items</h3>
                    <div class="flex space-x-4 overflow-x-auto pb-4 -mb-4">
                        <div class="flex-shrink-0 w-64 bg-white dark:bg-gray-700 rounded-xl shadow-md overflow-hidden relative group cursor-pointer">
                            <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?q=80&w=1999&auto=format&fit=crop" alt="Featured Product" class="w-full h-40 object-cover transition-transform duration-300 group-hover:scale-105">
                            <div class="absolute bottom-0 left-0 p-3 bg-gradient-to-t from-black/70 to-transparent w-full">
                                <h4 class="font-bold text-white">Premium Smart Watch</h4>
                                <p class="text-sm text-gray-200">Like new, with box</p>
                            </div>
                        </div>
                        <div class="flex-shrink-0 w-64 bg-white dark:bg-gray-700 rounded-xl shadow-md overflow-hidden relative group cursor-pointer">
                            <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=2070&auto=format&fit=crop" alt="Featured Product" class="w-full h-40 object-cover transition-transform duration-300 group-hover:scale-105">
                            <div class="absolute bottom-0 left-0 p-3 bg-gradient-to-t from-black/70 to-transparent w-full"><h4 class="font-bold text-white">Running Shoes</h4><p class="text-sm text-gray-200">Size 9, barely used</p></div>
                        </div>
                    </div>
                </section>
                <div class="relative">
                    <i class="ph ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"></i>
                    <input type="text" placeholder="Search products..." class="bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 w-full rounded-full py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-400">
                </div>
                <section>
                    <h3 class="font-bold text-gray-800 dark:text-gray-200 mb-3 text-lg">Categories</h3>
                    <div class="grid grid-cols-4 gap-4 text-center">
                        <div class="marketplace-category cursor-pointer" data-category="electronics"><div class="bg-blue-100 dark:bg-blue-900/50 text-blue-500 dark:text-blue-400 p-3 rounded-xl inline-block"><i class="ph ph-device-mobile text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Electronics</span></div>
                        <div class="marketplace-category cursor-pointer" data-category="fashion"><div class="bg-green-100 dark:bg-green-900/50 text-green-500 dark:text-green-400 p-3 rounded-xl inline-block"><i class="ph ph-t-shirt text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Fashion</span></div>
                        <div class="marketplace-category cursor-pointer" data-category="furniture"><div class="bg-purple-100 dark:bg-purple-900/50 text-purple-500 dark:text-purple-400 p-3 rounded-xl inline-block"><i class="ph ph-couch text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Furniture</span></div>
                        <div class="marketplace-category cursor-pointer" data-category="books"><div class="bg-yellow-100 dark:bg-yellow-900/50 text-yellow-500 dark:text-yellow-400 p-3 rounded-xl inline-block"><i class="ph ph-books text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Books</span></div>
                        <div class="marketplace-category cursor-pointer" data-category="decor"><div class="bg-pink-100 dark:bg-pink-900/50 text-pink-500 dark:text-pink-400 p-3 rounded-xl inline-block"><i class="ph ph-lamp text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Home Decor</span></div>
                        <div class="marketplace-category cursor-pointer" data-category="food"><div class="bg-red-100 dark:bg-red-900/50 text-red-500 dark:text-red-400 p-3 rounded-xl inline-block"><i class="ph ph-hamburger text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Foods</span></div>
                        <div class="marketplace-category cursor-pointer" data-category="vehicle"><div class="bg-teal-100 dark:bg-teal-900/50 text-teal-500 dark:text-teal-400 p-3 rounded-xl inline-block"><i class="ph ph-car text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">Vehicle</span></div>
                        <div class="marketplace-category cursor-pointer" data-category="all"><div class="bg-indigo-100 dark:bg-indigo-900/50 text-indigo-500 dark:text-indigo-400 p-3 rounded-xl inline-block"><i class="ph ph-dots-three-outline text-2xl"></i></div><span class="text-xs mt-2 block text-gray-600 dark:text-gray-400">All</span></div>
                    </div>
                </section>
                <section>
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-gray-800 dark:text-gray-200 text-lg">New Listings</h3>
                        <a href="#" class="text-sm font-semibold text-blue-500 dark:text-blue-400">See All</a>
                    </div>
                    <div id="marketplace-content" class="grid grid-cols-2 gap-4">
                        <!-- Marketplace items will be injected here by JS -->
                    </div>
                </section>
            </main>
        </div>

        <!-- Bottom Navigation Bar -->
        <nav class="fixed bottom-0 left-0 right-0 max-w-lg mx-auto bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg border-t border-gray-200 dark:border-gray-700 flex justify-around py-3 z-20">
            <a href="#" class="nav-link flex flex-col items-center text-gray-500 dark:text-gray-400 nav-active" data-page="home">
                <i class="ph ph-house text-2xl"></i><span class="text-xs font-semibold">Home</span>
            </a>
            <a href="#" class="nav-link flex flex-col items-center text-gray-500 dark:text-gray-400" data-page="payments">
                <i class="ph ph-credit-card text-2xl"></i><span class="text-xs">Payments</span>
            </a>
            <a href="#" class="nav-link flex flex-col items-center text-gray-500 dark:text-gray-400" data-page="marketplace">
                <i class="ph ph-storefront text-2xl"></i><span class="text-xs">Marketplace</span>
            </a>
            <a href="#" class="nav-link flex flex-col items-center text-gray-500 dark:text-gray-400" data-page="security">
                <i class="ph ph-shield-check text-2xl"></i><span class="text-xs">Security</span>
            </a>
            <!-- Floating Action Button for Marketplace -->
            <button id="add-listing-fab" class="absolute -top-8 left-1/2 -translate-x-1/2 bg-blue-500 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center hover:bg-blue-600 transition-all transform hover:scale-110">
                <i class="ph ph-plus text-2xl"></i>
            </button>
        </nav>

        <!-- Detail View (Initially off-screen) -->
        <div id="detail-view" class="absolute inset-0 bg-white dark:bg-gray-800 z-30 transform translate-x-full">
            <header class="p-4 flex items-center sticky top-0 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm z-10 border-b border-gray-100 dark:border-gray-700">
                <button id="detail-back-btn"><i class="ph ph-arrow-left text-2xl text-gray-800 dark:text-gray-200"></i></button>
                <h2 id="detail-title" class="text-lg font-bold text-gray-800 dark:text-gray-200 mx-auto">Details</h2>
            </header>
            <div id="detail-content" class="p-4"></div>
        </div>

        <!-- Profile Drawer (Initially off-screen) -->
        <div id="drawer-overlay" class="overlay fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
        <div id="profile-drawer" class="fixed top-0 right-0 h-full w-72 bg-white dark:bg-gray-800 shadow-2xl z-50 transform translate-x-full">
            <div class="p-4 border-b dark:border-gray-700 flex justify-between items-center">
                <h3 class="font-bold text-lg text-gray-800 dark:text-gray-200">Profile & Settings</h3>
                <button id="profile-drawer-close-btn" class="text-gray-500 dark:text-gray-400"><i class="ph ph-x text-xl"></i></button>
            </div>
            <div class="p-4 space-y-6">
                <div class="flex items-center space-x-4">
                    <img src="https://i.pravatar.cc/150?img=3" alt="User Avatar" class="w-16 h-16 rounded-full">
                    <div>
                        <h4 class="font-bold text-gray-800 dark:text-gray-200">Piyush</h4>
                        <p class="text-sm text-gray-500 dark:text-gray-400">View Profile</p>
                    </div>
                </div>
                <div class="space-y-2">
                    <a href="#" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300">
                        <i class="ph ph-gear"></i><span>Account Settings</span>
                    </a>
                    <a href="#" class="flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300">
                        <i class="ph ph-bell"></i><span>Notifications</span>
                    </a>
                </div>
                <button id="logout-btn" class="w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600 transition-colors">Logout</button>
            </div>
        </div>

        <!-- Modals -->
        <div id="helpdesk-modal" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 hidden">
            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-2xl p-6 w-full max-w-sm text-center">
                <i class="ph ph-question text-4xl text-blue-500 dark:text-blue-400 mx-auto"></i>
                <h3 class="text-xl font-bold mt-4 mb-2 text-gray-800 dark:text-gray-200">Helpdesk</h3>
                <p class="text-gray-600 dark:text-gray-400 mb-6">How can we assist you today?</p>
                <div class="space-y-3">
                    <button class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600">Contact Support</button>
                    <button class="w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-500">View FAQs</button>
                </div>
                <button class="modal-close-btn mt-6 text-sm text-gray-500 dark:text-gray-400" data-modal="helpdesk-modal">Close</button>
            </div>
        </div>
        <div id="entries-modal" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 hidden">
            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-2xl p-6 w-full max-w-sm">
                <h3 class="text-xl font-bold mb-4 text-gray-800 dark:text-gray-200">Future Entries</h3>
                <div class="space-y-3 max-h-60 overflow-y-auto">
                    <div class="bg-gray-50 dark:bg-gray-600 p-3 rounded-lg flex justify-between items-center">
                        <div><p class="font-semibold text-gray-800 dark:text-gray-200">Aryash (Guest)</p><p class="text-sm text-gray-500 dark:text-gray-400">Tomorrow, 10:00 AM</p></div>
                        <span class="text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 px-2 py-1 rounded-full">Approved</span>
                    </div>
                </div>
                <button class="modal-close-btn mt-6 w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg" data-modal="entries-modal">Close</button>
            </div>
        </div>
        <!-- QR Code Modal -->
        <div id="qr-modal" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 hidden">
            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-2xl p-6 w-full max-w-sm text-center">
                <h3 class="text-xl font-bold mb-4 text-gray-800 dark:text-gray-200">Scan for Entry</h3>
                <img src="Piyush.png" alt="QR Code" class="mx-auto rounded-lg w-52 h-52">
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-4">Show this QR code at the gate for quick entry.</p>
                <button class="modal-close-btn mt-6 w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg" data-modal="qr-modal">Close</button>
            </div>
        </div>
        <!-- Home Services Modal -->
        <div id="services-modal" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 hidden">
            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-2xl p-6 w-full max-w-sm">
                <h3 class="text-xl font-bold mb-6 text-gray-800 dark:text-gray-200 text-center">Home Services</h3>
                <div class="grid grid-cols-2 gap-4">
                    <button class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg text-center hover:bg-gray-100 dark:hover:bg-gray-500">
                        <i class="ph ph-paint-brush text-3xl text-red-500"></i><span class="block mt-2 text-sm font-semibold text-gray-700 dark:text-gray-200">Painting</span>
                    </button>
                    <button class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg text-center hover:bg-gray-100 dark:hover:bg-gray-500">
                        <i class="ph ph-plugs-connected text-3xl text-teal-500"></i><span class="block mt-2 text-sm font-semibold text-gray-700 dark:text-gray-200">Electrician</span>
                    </button>
                    <button class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg text-center hover:bg-gray-100 dark:hover:bg-gray-500">
                        <i class="ph ph-faucet text-3xl text-sky-500"></i><span class="block mt-2 text-sm font-semibold text-gray-700 dark:text-gray-200">Plumbing</span>
                    </button>
                    <button class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg text-center hover:bg-gray-100 dark:hover:bg-gray-500">
                        <i class="ph ph-broom text-3xl text-orange-500"></i><span class="block mt-2 text-sm font-semibold text-gray-700 dark:text-gray-200">Cleaning</span>
                    </button>
                </div>
                <button class="modal-close-btn mt-6 w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg" data-modal="services-modal">Close</button>
            </div>
        </div>
        <!-- SOS Modal -->
        <div id="sos-modal" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 hidden">
            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-2xl p-6 w-full max-w-sm text-center">
                <div id="sos-confirmation-content">
                    <i class="ph ph-siren text-5xl text-red-500 animate-pulse"></i>
                    <h3 class="text-xl font-bold mt-4 mb-2 text-gray-800 dark:text-gray-200">Emergency SOS</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">This will immediately alert security. Are you sure you want to proceed?</p>
                    <button id="confirm-sos-btn" class="w-full bg-red-500 text-white font-bold py-3 rounded-lg hover:bg-red-600 transition-colors sos-pulse">Confirm SOS</button>
                    <button class="modal-close-btn mt-4 text-sm text-gray-500 dark:text-gray-400" data-modal="sos-modal">Cancel</button>
                </div>
                <div id="sos-sent-content" class="hidden">
                    <i class="ph ph-check-circle text-5xl text-green-500"></i><h3 class="text-xl font-bold mt-4 mb-2 text-gray-800 dark:text-gray-200">Alert Sent</h3><p class="text-gray-600 dark:text-gray-400">Security has been notified and will be in touch shortly.</p><button class="modal-close-btn mt-6 w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg" data-modal="sos-modal">Close</button>
                </div>
            </div>
        </div>
        <!-- Clubhouse Modal -->
        <div id="clubhouse-modal" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 hidden">
            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-2xl p-6 w-full max-w-md">
                <div id="clubhouse-booking-content">
                    <h3 class="text-xl font-bold mb-6 text-gray-800 dark:text-gray-200 text-center">Book an Amenity</h3>
                    <div class="space-y-4">
                        <div class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg flex items-center justify-between">
                            <div class="flex items-center space-x-4"><i class="ph ph-swimming-pool text-3xl text-blue-500"></i>
                                <div><p class="font-semibold text-gray-800 dark:text-gray-200">Swimming Pool</p><p class="text-sm text-green-600 dark:text-green-400">Available</p></div>
                            </div><button class="book-amenity-btn bg-blue-500 text-white text-sm font-semibold px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">Book Now</button>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg flex items-center justify-between">
                            <div class="flex items-center space-x-4"><i class="ph ph-barbell text-3xl text-orange-500"></i>
                                <div><p class="font-semibold text-gray-800 dark:text-gray-200">Gymnasium</p><p class="text-sm text-green-600 dark:text-green-400">Available</p></div>
                            </div><button class="book-amenity-btn bg-blue-500 text-white text-sm font-semibold px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">Book Now</button>
                        </div>
                        <div class="bg-gray-50 dark:bg-gray-600 p-4 rounded-lg flex items-center justify-between">
                            <div class="flex items-center space-x-4"><i class="ph ph-confetti text-3xl text-purple-500"></i>
                                <div><p class="font-semibold text-gray-800 dark:text-gray-200">Party Hall</p><p class="text-sm text-red-600 dark:text-red-400">Booked until 8 PM</p></div>
                            </div><button class="bg-gray-300 dark:bg-gray-500 text-gray-600 dark:text-gray-300 text-sm font-semibold px-4 py-2 rounded-lg cursor-not-allowed" disabled>Booked</button>
                        </div>
                    </div><button class="modal-close-btn mt-6 w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg" data-modal="clubhouse-modal">Close</button>
                </div>
                <div id="clubhouse-booked-content" class="hidden text-center"><i class="ph ph-check-circle text-5xl text-green-500"></i><h3 class="text-xl font-bold mt-4 mb-2 text-gray-800 dark:text-gray-200">Booking Confirmed!</h3><p class="text-gray-600 dark:text-gray-400">Your amenity has been booked. You will receive a confirmation shortly.</p><button class="modal-close-btn mt-6 w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg" data-modal="clubhouse-modal">Done</button></div>
            </div>
        </div>
        <!-- Delivery Modal -->
        <div id="delivery-modal" class="fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 hidden">
            <div class="bg-white dark:bg-gray-700 rounded-xl shadow-2xl p-6 w-full max-w-sm">
                <div id="delivery-form-content">
                    <h3 class="text-xl font-bold mb-6 text-gray-800 dark:text-gray-200 text-center">Pre-Approve a Delivery</h3>
                    <form id="delivery-form" class="space-y-4">
                        <div><label for="delivery-service" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Delivery Service</label><select id="delivery-service" class="w-full bg-gray-50 dark:bg-gray-600 border border-gray-300 dark:border-gray-500 text-gray-900 dark:text-gray-200 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5"><option selected>Choose a service</option><option value="Amazon">Amazon</option><option value="Flipkart">Flipkart</option><option value="Zomato">Zomato</option><option value="Swiggy">Swiggy</option><option value="Other">Other</option></select></div>
                        <div class="flex items-center"><input id="leave-at-gate" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"><label for="leave-at-gate" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-300">Allow leaving package at the gate</label></div>
                        <div class="pt-4"><button type="submit" id="approve-delivery-btn" class="w-full bg-blue-500 text-white font-semibold py-2.5 rounded-lg hover:bg-blue-600 transition-colors">Approve Delivery</button><button type="button" class="modal-close-btn mt-3 w-full text-sm text-gray-500 dark:text-gray-400" data-modal="delivery-modal">Cancel</button></div>
                    </form>
                </div>
                <div id="delivery-approved-content" class="hidden text-center">
                    <i class="ph ph-check-circle text-5xl text-green-500"></i><h3 class="text-xl font-bold mt-4 mb-2 text-gray-800 dark:text-gray-200">Delivery Approved!</h3><p class="text-gray-600 dark:text-gray-400">Security has been notified to expect your delivery.</p><button class="modal-close-btn mt-6 w-full bg-gray-100 dark:bg-gray-600 text-gray-800 dark:text-gray-200 py-2 rounded-lg" data-modal="delivery-modal">Done</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- MOCK DATA ---
            const visitorUpdatesData = [
                { id: 'v1', icon: 'ph-bell-ringing', title: 'Pre-Approved Entry', description: 'Your guest, Aarav Garg, is pre-approved for tomorrow.', time: '15m ago' },
                { id: 'v2', icon: 'ph-package', title: 'Package Arrived', description: 'A package from Amazon has arrived for you at the gate.', time: '1h ago' },
                { id: 'v3', icon: 'ph-car', title: 'Cab Arrived', description: 'Your Uber is waiting at the main entrance.', time: '3h ago' },
            ];
            const communityPostsData = [
                { 
                    id: 'p1', avatar: 'https://i.pravatar.cc/150?img=1', name: 'Rohit', handle: '@rohit', time: '2h ago', content: 'Has anyone seen a lost golden retriever puppy near Block C? Responds to the name "Buddy". He is very friendly.', image: null, likes: 12, comments: 5,
                    commentsData: [
                        { avatar: 'https://i.pravatar.cc/150?img=5', name: 'Neha', text: 'I think I saw a puppy near the park entrance an hour ago!' },
                        { avatar: 'https://i.pravatar.cc/150?img=6', name: 'Karan', text: 'Hope you find him soon! Will keep an eye out.' },
                    ]
                },
                { 
                    id: 'p2', avatar: 'https://i.pravatar.cc/150?img=2', name: 'Vijay', handle: '@vijay', time: '5h ago', content: 'Reminder: Free yoga session in the community park this Sunday at 7 AM. All are welcome, bring your own mats!', image: null, likes: 45, comments: 18,
                    commentsData: [
                        { avatar: 'https://i.pravatar.cc/150?img=7', name: 'Sunita', text: 'Looking forward to it! I will be there.' },
                        { avatar: 'https://i.pravatar.cc/150?img=8', name: 'Amit', text: 'Great initiative, Vijay!' },
                    ]
                },
                { 
                    id: 'p3', avatar: 'https://i.pravatar.cc/150?img=4', name: 'Anjali', handle: '@anjali', time: '1d ago', content: 'The community garden is looking beautiful this season! Thanks to everyone who helped out.', image: null, likes: 82, comments: 25,
                    commentsData: [
                        { avatar: 'https://i.pravatar.cc/150?img=9', name: 'Mr. Verma', text: 'It truly is a wonderful addition to our community. Well done team.' },
                    ]
                },
            ];
            const paymentsData = [
                { id: 'pay1', title: 'Monthly Maintenance', amount: -2500, date: '2023-11-05', status: 'Paid', icon: 'ph-shield-check', iconBg: 'bg-green-100 dark:bg-green-900/50', iconColor: 'text-green-500 dark:text-green-400' },
                { id: 'pay2', title: 'Electricity Bill', amount: -1250, date: 'Due in 3 days', status: 'Due', icon: 'ph-lightning', iconBg: 'bg-yellow-100 dark:bg-yellow-900/50', iconColor: 'text-yellow-500 dark:text-yellow-400' },
                { id: 'pay3', title: 'Clubhouse Booking', amount: -500, date: '2023-11-12', status: 'Paid', icon: 'ph-game-controller', iconBg: 'bg-green-100 dark:bg-green-900/50', iconColor: 'text-green-500 dark:text-green-400' },
                { id: 'pay4', title: 'Water Bill', amount: -550, date: 'Overdue by 5 days', status: 'Overdue', icon: 'ph-drop', iconBg: 'bg-red-100 dark:bg-red-900/50', iconColor: 'text-red-500 dark:text-red-400' },
                { id: 'pay5', title: 'Gas Bill', amount: -800, date: '2023-10-20', status: 'Paid', icon: 'ph-fire', iconBg: 'bg-green-100 dark:bg-green-900/50', iconColor: 'text-green-500 dark:text-green-400' },
            ];
            const securityLogData = [
                { id: 'log1', title: 'Guest Entry: Aarav Garg', time: '10:32 AM', icon: 'ph-user', iconBg: 'bg-blue-100 dark:bg-blue-900/50', iconColor: 'text-blue-500 dark:text-blue-400' },
                { id: 'log2', title: 'Delivery: Amazon', time: '9:15 AM', icon: 'ph-package', iconBg: 'bg-orange-100 dark:bg-orange-900/50', iconColor: 'text-orange-500 dark:text-orange-400' },
                { id: 'log3', title: 'Gate Opened via App', time: '8:00 AM', icon: 'ph-mobile', iconBg: 'bg-green-100 dark:bg-green-900/50', iconColor: 'text-green-500 dark:text-green-400' },
                { id: 'log4', title: 'SOS Alert Triggered', time: 'Yesterday', icon: 'ph-siren', iconBg: 'bg-red-100 dark:bg-red-900/50', iconColor: 'text-red-500 dark:text-red-400' },
                { id: 'log5', title: 'Password Changed', time: '2 days ago', icon: 'ph-key', iconBg: 'bg-yellow-100 dark:bg-yellow-900/50', iconColor: 'text-yellow-500 dark:text-yellow-400' },
            ];
            const connectedDevicesData = [
                { id: 'dev1', name: 'Chrome on Windows', location: 'Delhi, IN (Current)', icon: 'ph-desktop', iconBg: 'bg-green-100 dark:bg-green-900/50', iconColor: 'text-green-500 dark:text-green-400', isCurrent: true },
                { id: 'dev2', name: 'iPhone 14 Pro', location: 'Mumbai, IN', icon: 'ph-device-mobile', iconBg: 'bg-gray-100 dark:bg-gray-600', iconColor: 'text-gray-500 dark:text-gray-400', isCurrent: false },
                { id: 'dev3', name: 'Safari on MacBook', location: 'Bangalore, IN', icon: 'ph-laptop', iconBg: 'bg-gray-100 dark:bg-gray-600', iconColor: 'text-gray-500 dark:text-gray-400', isCurrent: false },
            ];
            const marketplaceData = [
                { id: 'm1', title: 'Used Bicycle', price: 3000, category: 'vehicle', image: 'https://images.unsplash.com/photo-1485965120184-e220f721d03e?q=80&w=2070&auto=format&fit=crop', seller: 'Rohan S.', avatar: 'https://i.pravatar.cc/150?img=11', location: 'Block A' },
                { id: 'm2', title: 'Study Table', price: 1500, category: 'furniture', image: 'https://images.unsplash.com/photo-1533090481720-856c6e3c1fdc?q=80&w=1887&auto=format&fit=crop', seller: 'Priya K.', avatar: 'https://i.pravatar.cc/150?img=5', location: 'Block C' },
                { id: 'm3', title: 'Gaming Headphones', price: 4999, category: 'electronics', image: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?q=80&w=2070&auto=format&fit=crop', seller: 'Amit G.', avatar: 'https://i.pravatar.cc/150?img=8', location: 'Block B' },
                { id: 'm4', title: 'Vintage Leather Jacket', price: 8500, category: 'fashion', image: 'https://images.unsplash.com/photo-1521223890158-f9f7c3d5d504?q=80&w=1995&auto=format&fit=crop', seller: 'Sneha M.', avatar: 'https://i.pravatar.cc/150?img=32', location: 'Block D' },
                { id: 'm5', title: 'Bestseller Novel Set', price: 999, category: 'books', image: 'https://images.unsplash.com/photo-1544947950-fa07a98d237f?q=80&w=1887&auto=format&fit=crop', seller: 'Karan V.', avatar: 'https://i.pravatar.cc/150?img=12', location: 'Block A' },
                { id: 'm6', title: 'Modern Art Vase', price: 750, category: 'decor', image: 'modern art vase.png', seller: 'Anjali R.', avatar: 'https://i.pravatar.cc/150?img=35', location: 'Block C' },
                { id: 'm7', title: 'Homemade Chocolate Cake', price: 500, category: 'food', image: 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?q=80&w=1987&auto=format&fit=crop', seller: 'Sunita P.', avatar: 'https://i.pravatar.cc/150?img=45', location: 'Block B' },
                { id: 'm8', title: 'Used Electric Scooter', price: 45000, category: 'vehicle', image: 'EV scooty.png', seller: 'Vikram N.', avatar: 'https://i.pravatar.cc/150?img=14', location: 'Block D' },
            ];

            // --- DOM ELEMENTS ---
            const dom = {
                appContainer: document.getElementById('app-container'),
                mainScrollArea: document.getElementById('main-scroll-area'),
                visitorContent: document.getElementById('visitor-updates-content'),
                communityContent: document.getElementById('community-posts-content'),
                tabVisitor: document.getElementById('tab-visitor'),
                tabCommunity: document.getElementById('tab-community'),
                searchBar: document.getElementById('search-bar'),
                quickActionItems: document.querySelectorAll('.quick-action-item'),
                modalCloseBtns: document.querySelectorAll('.modal-close-btn'),
                detailView: document.getElementById('detail-view'),
                detailTitle: document.getElementById('detail-title'),
                detailContent: document.getElementById('detail-content'),
                detailBackBtn: document.getElementById('detail-back-btn'),
                darkModeToggle: document.getElementById('dark-mode-toggle'),
                darkModeIcon: document.querySelector('#dark-mode-toggle i'),
                profileDrawerBtn: document.getElementById('profile-drawer-btn'),
                profileDrawer: document.getElementById('profile-drawer'),
                profileDrawerCloseBtn: document.getElementById('profile-drawer-close-btn'),
                drawerOverlay: document.getElementById('drawer-overlay'),
                pullToRefreshIndicator: document.getElementById('pull-to-refresh-indicator'),
                pullToRefreshIcon: document.querySelector('#pull-to-refresh-indicator i'),
                paymentsPage: document.getElementById('payments-page'),
                securityPage: document.getElementById('security-page'),
                marketplacePage: document.getElementById('marketplace-page'),
                paymentsContent: document.getElementById('payments-content'),
                marketplaceContent: document.getElementById('marketplace-content'),
                paymentFilterBtns: document.querySelectorAll('.payment-filter-btn'),
                securityContent: document.getElementById('security-content'),
                connectedDevicesContent: document.getElementById('connected-devices-content'),
                navLinks: document.querySelectorAll('.nav-link'),
                confirmSosBtn: document.getElementById('confirm-sos-btn'),
                clubhouseModal: document.getElementById('clubhouse-modal'),
                deliveryModal: document.getElementById('delivery-modal'),
                addListingFab: document.getElementById('add-listing-fab'),
            };

            // --- STATE ---
            let state = {
                activeTab: 'visitor',
                currentPage: 'home',
                touchStartY: 0,
                isRefreshing: false,
            };

            // --- RENDER FUNCTIONS ---
            const renderSkeletons = (container, count = 3) => {
                let skeletons = '';
                for (let i = 0; i < count; i++) {
                    skeletons += `
                        <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-xl flex items-center space-x-4">
                            <div class="w-12 h-12 rounded-full bg-gray-200 dark:bg-gray-600 skeleton"></div>
                            <div class="flex-1 space-y-2">
                                <div class="w-3/4 h-4 bg-gray-200 dark:bg-gray-600 rounded skeleton"></div>
                                <div class="w-1/2 h-4 bg-gray-200 dark:bg-gray-600 rounded skeleton"></div>
                            </div>
                        </div>
                    `;
                }
                container.innerHTML = skeletons;
            };

            const renderVisitorUpdates = (filter = '') => {
                const data = visitorUpdatesData.filter(item => item.title.toLowerCase().includes(filter) || item.description.toLowerCase().includes(filter));
                dom.visitorContent.innerHTML = data.length ? `<div class="relative pl-8 before:absolute before:top-0 before:left-3 before:h-full before:w-0.5 before:bg-gray-200 dark:before:bg-gray-700">${data.map(item => `
                    <div class="relative mb-8 cursor-pointer group" data-id="${item.id}" data-type="visitor">
                        <div class="absolute -left-1.5 top-0 flex h-9 w-9 items-center justify-center rounded-full bg-gradient-to-br from-blue-400 to-blue-600 text-white ring-8 ring-white dark:ring-gray-800">
                            <i class="ph ${item.icon} text-lg"></i>
                        </div>
                        <div class="ml-10 rounded-xl bg-white p-4 shadow-md transition-all group-hover:-translate-y-1 group-hover:shadow-lg dark:bg-gray-700">
                            <div class="flex items-center justify-between">
                                <h4 class="font-bold text-gray-800 dark:text-gray-200">${item.title}</h4>
                                <span class="text-xs text-gray-500 dark:text-gray-400">${item.time}</span>
                            </div>
                            <p class="mt-1 text-sm text-gray-600 dark:text-gray-400">${item.description}</p>
                            <div class="mt-3 flex justify-end">
                                <button class="text-xs font-semibold text-blue-500 hover:underline dark:text-blue-400">View Details</button>
                            </div>
                        </div>
                    </div>`).join('')}</div>` : `<p class="text-center text-gray-500 dark:text-gray-400">No updates found.</p>`;
            };

            const renderCommunityPosts = (filter = '') => {
                const data = communityPostsData.filter(item => item.name.toLowerCase().includes(filter) || item.content.toLowerCase().includes(filter));
                dom.communityContent.innerHTML = data.length ? data.map(post => {
                    const imageHTML = post.image ? `<div class="mt-3 -mx-4"><img src="${post.image}" alt="Post image" class="w-full h-auto"></div>` : '';
                    const commentsHTML = post.commentsData.map(comment => `
                        <div class="flex items-start space-x-2.5">
                            <img src="${comment.avatar}" alt="avatar" class="w-8 h-8 rounded-full">
                            <div class="flex-1 bg-gray-100 dark:bg-gray-600 rounded-xl p-2.5">
                                <p class="font-semibold text-sm text-gray-800 dark:text-gray-200">${comment.name}</p>
                                <p class="text-sm text-gray-600 dark:text-gray-400">${comment.text}</p>
                            </div>
                        </div>
                    `).join('');

                    return `
                    <div class="bg-white dark:bg-gray-700/50 border border-gray-200 dark:border-gray-700 rounded-xl shadow-sm overflow-hidden" data-id="${post.id}" data-type="post">
                        <div class="p-4">
                            <div class="flex items-start space-x-3">
                                <img src="${post.avatar}" alt="avatar" class="w-10 h-10 rounded-full cursor-pointer">
                                <div class="flex-1">
                                    <div class="flex items-baseline space-x-2">
                                        <h5 class="font-bold text-gray-800 dark:text-gray-200">${post.name}</h5>
                                        <span class="text-sm text-gray-500 dark:text-gray-400">${post.handle} &middot; ${post.time}</span>
                                    </div>
                                    <p class="mt-1 text-gray-700 dark:text-gray-300">${post.content}</p>
                                </div>
                            </div>
                        </div>
                        ${imageHTML}
                        <div class="px-4 py-2 border-t border-gray-100 dark:border-gray-700/50 flex justify-around text-gray-500 dark:text-gray-400">
                            <button class="flex items-center space-x-1 hover:text-red-500 transition-colors cursor-pointer"><i class="ph ph-heart text-lg"></i><span class="text-sm">${post.likes}</span></button>
                            <button class="flex items-center space-x-1 hover:text-blue-500 transition-colors cursor-pointer" data-action="toggle-comments"><i class="ph ph-chat-circle-dots text-lg"></i><span class="text-sm">${post.comments}</span></button>
                            <button class="flex items-center space-x-1 hover:text-green-500 transition-colors cursor-pointer"><i class="ph ph-share-network text-lg"></i><span class="text-sm">Share</span></button>
                        </div>
                        <div class="comments-section hidden p-4 border-t border-gray-100 dark:border-gray-700/50 space-y-4">
                            ${commentsHTML}
                        </div>
                    </div>
                    `;
                }).join('') : `<p class="text-center text-gray-500 dark:text-gray-400">No posts found.</p>`;
            };

            const renderPayments = (filter = 'all') => {
                const filteredData = paymentsData.filter(p => {
                    if (filter === 'all') return true;
                    if (filter === 'due') return p.status === 'Due' || p.status === 'Overdue';
                    if (filter === 'paid') return p.status === 'Paid';
                });

                dom.paymentsContent.innerHTML = filteredData.map(p => {
                    const statusClasses = {
                        'Paid': 'bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300',
                        'Due': 'bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300',
                        'Overdue': 'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300'
                    };
                    const amountColor = p.status === 'Paid' ? 'text-gray-500 dark:text-gray-400' : 'text-red-500 dark:text-red-400';

                    return `
                    <div class="bg-white dark:bg-gray-700 p-4 rounded-xl flex items-center space-x-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer">
                        <div class="${p.iconBg} p-3 rounded-full"><i class="ph ${p.icon} text-xl ${p.iconColor}"></i></div>
                        <div class="flex-1">
                            <h4 class="font-bold text-gray-800 dark:text-gray-200">${p.title}</h4>
                            <p class="text-sm text-gray-500 dark:text-gray-400">${p.date}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold ${amountColor}">â‚¹${Math.abs(p.amount).toLocaleString()}</p>
                            <span class="text-xs font-medium ${statusClasses[p.status]} px-2 py-1 rounded-full">${p.status}</span>
                        </div>
                    </div>
                `}).join('');
            };

            const renderSecurityLogs = () => {
                dom.securityContent.innerHTML = securityLogData.map(log => `
                    <div class="bg-white dark:bg-gray-700 p-4 rounded-xl flex items-center space-x-4 shadow-sm">
                        <div class="${log.iconBg} p-3 rounded-full"><i class="ph ${log.icon} text-xl ${log.iconColor}"></i></div>
                        <div class="flex-1">
                            <p class="font-semibold text-gray-800 dark:text-gray-200">${log.title}</p>
                            <p class="text-xs text-gray-500 dark:text-gray-400">${log.time}</p>
                        </div>
                        <i class="ph ph-caret-right text-gray-400"></i>
                    </div>
                `).join('');
            };

            const renderConnectedDevices = () => {
                dom.connectedDevicesContent.innerHTML = connectedDevicesData.map(device => `
                    <div class="bg-white dark:bg-gray-700 p-4 rounded-xl flex items-center space-x-4 shadow-sm">
                        <div class="${device.iconBg} p-3 rounded-full"><i class="ph ${device.icon} text-xl ${device.iconColor}"></i></div>
                        <div class="flex-1">
                            <p class="font-semibold text-gray-800 dark:text-gray-200">${device.name}</p>
                            <p class="text-xs ${device.isCurrent ? 'text-green-500 dark:text-green-400' : 'text-gray-500 dark:text-gray-400'}">${device.location}</p>
                        </div>
                        ${!device.isCurrent ? `
                            <button class="text-xs font-semibold text-red-500 hover:underline dark:text-red-400">
                                Log Out
                            </button>
                        ` : ''}
                    </div>
                `).join('');
            };

            const renderMarketplace = (category = 'all') => {
                const filteredData = marketplaceData.filter(item => category === 'all' || item.category === category);

                dom.marketplaceContent.innerHTML = filteredData.map(item => `
                    <div class="marketplace-item bg-white dark:bg-gray-700 rounded-xl shadow-sm overflow-hidden group cursor-pointer" data-category="${item.category}">
                        <div class="relative">
                            <img src="${item.image}" alt="${item.title}" class="w-full h-32 object-cover transition-transform duration-300 group-hover:scale-105">
                            <button class="favorite-btn absolute top-2 right-2 bg-black/30 text-white w-8 h-8 rounded-full flex items-center justify-center backdrop-blur-sm">
                                <i class="ph ph-heart text-lg"></i>
                                <i class="ph-fill ph-heart text-lg text-red-500 hidden"></i>
                            </button>
                        </div>
                        <div class="p-3">
                            <h4 class="font-semibold text-sm text-gray-800 dark:text-gray-200 truncate">${item.title}</h4>
                            <p class="text-lg font-bold text-blue-500 dark:text-blue-400">â‚¹${item.price.toLocaleString()}</p>
                            <div class="flex items-center mt-2 text-xs text-gray-500 dark:text-gray-400">
                                <img src="${item.avatar}" class="w-5 h-5 rounded-full mr-1.5">
                                <span>${item.seller} &middot; ${item.location}</span>
                            </div>
                        </div>
                    </div>
                `).join('');

                // Highlight active category
                document.querySelectorAll('.marketplace-category').forEach(cat => {
                    const iconContainer = cat.querySelector('div');
                    iconContainer.classList.toggle('ring-2', cat.dataset.category === category);
                    iconContainer.classList.toggle('ring-blue-500', cat.dataset.category === category);
                });
            };

            // --- CORE LOGIC ---
            const loadContent = (isRefresh = false) => {
                if (state.isRefreshing) return;
                state.isRefreshing = true;
                if (isRefresh) dom.pullToRefreshIcon.classList.add('animate-spin');
                
                renderSkeletons(dom.visitorContent);
                renderSkeletons(dom.communityContent);

                setTimeout(() => {
                    handleSearch(); // This will re-render with actual data
                    if (isRefresh) {
                        dom.pullToRefreshIndicator.style.transform = 'translateY(-100%)';
                        dom.pullToRefreshIcon.classList.remove('animate-spin');
                    }
                    state.isRefreshing = false;
                }, 1500);
            };

            const switchTab = (tab) => {
                state.activeTab = tab;
                dom.tabVisitor.classList.toggle('tab-active', tab === 'visitor');
                dom.tabCommunity.classList.toggle('tab-active', tab === 'community');
                dom.visitorContent.classList.toggle('hidden', tab !== 'visitor');
                dom.communityContent.classList.toggle('hidden', tab !== 'community');
                handleSearch();
            };

            const handleSearch = () => {
                const searchTerm = dom.searchBar.value.toLowerCase();
                if (state.activeTab === 'visitor') renderVisitorUpdates(searchTerm);
                else renderCommunityPosts(searchTerm);
            };

            const openModal = (modalId) => document.getElementById(modalId)?.classList.remove('hidden');
            const closeModal = (modalId) => document.getElementById(modalId)?.classList.add('hidden');

            const openDetailView = (e) => {
                const card = e.target.closest('[data-id]');
                if (!card) return;
                const { id, type } = card.dataset;
                let item = type === 'visitor' ? visitorUpdatesData.find(v => v.id === id) : communityPostsData.find(p => p.id === id);
                if (item) {
                    dom.detailTitle.textContent = type === 'visitor' ? "Visitor Update" : "Community Post";
                    dom.detailContent.innerHTML = type === 'visitor' ? `<h3 class="text-2xl font-bold mb-2 text-gray-800 dark:text-gray-200">${item.title}</h3><p class="text-gray-600 dark:text-gray-400">${item.description}</p>` : `<p class="text-lg text-gray-700 dark:text-gray-300">${item.content}</p>`;
                    dom.detailView.classList.add('show');
                }
            };

            // --- PAGE NAVIGATION ---
            const navigateTo = (page) => {
                if (state.currentPage === page) return;

                // Hide all pages
                dom.mainScrollArea.classList.add('hidden');
                dom.paymentsPage.classList.add('hidden');
                dom.securityPage.classList.add('hidden');
                dom.marketplacePage.classList.add('hidden');

                // Deactivate all nav links
                dom.navLinks.forEach(link => link.classList.remove('nav-active'));

                // Show selected page and activate link
                document.getElementById(`${page}-page`)?.classList.remove('hidden');
                document.querySelector(`.nav-link[data-page="${page}"]`)?.classList.add('nav-active');
                
                state.currentPage = page;

                // Special handling for payments page
                if (page === 'payments') {
                    renderPayments('all');
                    document.querySelector('.payment-filter-btn[data-filter="all"]').classList.add('bg-blue-500', 'text-white', 'dark:bg-blue-500');
                }
                // Special handling for security page
                if (page === 'security') {
                    renderSecurityLogs();
                    renderConnectedDevices();
                    const scoreCircle = document.getElementById('security-score-circle');
                    if(scoreCircle) scoreCircle.classList.add('security-score-circle');
                }
                // Special handling for marketplace page
                if (page === 'marketplace') {
                    renderMarketplace('all');
                }

                // Toggle FAB visibility
                dom.addListingFab.classList.toggle('hidden', page !== 'marketplace');
            };

            // --- DARK MODE ---
            const initDarkMode = () => {
                const isDark = localStorage.getItem('darkMode') === 'true' || (localStorage.getItem('darkMode') === null && window.matchMedia('(prefers-color-scheme: dark)').matches);
                document.documentElement.classList.toggle('dark', isDark);
                dom.darkModeIcon.className = isDark ? 'ph-fill ph-sun text-2xl' : 'ph ph-moon text-2xl';
            };
            const toggleDarkMode = () => {
                const isDark = document.documentElement.classList.toggle('dark');
                localStorage.setItem('darkMode', isDark);
                dom.darkModeIcon.className = isDark ? 'ph-fill ph-sun text-2xl' : 'ph ph-moon text-2xl';
            };

            // --- PROFILE DRAWER ---
            const openDrawer = () => {
                dom.drawerOverlay.classList.remove('hidden');
                dom.profileDrawer.classList.add('show');
            };
            const closeDrawer = () => {
                dom.drawerOverlay.classList.add('hidden');
                dom.profileDrawer.classList.remove('show');
            };

            // --- PULL TO REFRESH ---
            const handleTouchStart = (e) => {
                if (dom.mainScrollArea.scrollTop === 0) state.touchStartY = e.touches[0].clientY;
            };
            const handleTouchMove = (e) => {
                if (state.touchStartY === 0 || state.isRefreshing) return;
                const pullDistance = e.touches[0].clientY - state.touchStartY;
                if (pullDistance > 0) {
                    e.preventDefault();
                    const pullRatio = Math.min(pullDistance / 150, 1);
                    dom.pullToRefreshIndicator.style.opacity = pullRatio;
                    dom.pullToRefreshIndicator.style.transform = `translateY(${pullDistance / 2.5}px)`;
                    dom.pullToRefreshIcon.style.transform = `rotate(${pullDistance}deg)`;
                }
            };
            const handleTouchEnd = (e) => {
                if (state.touchStartY === 0 || state.isRefreshing) return;
                const pullDistance = e.changedTouches[0].clientY - state.touchStartY;
                if (pullDistance > 100) {
                    loadContent(true);
                } else {
                    dom.pullToRefreshIndicator.style.transform = 'translateY(-100%)';
                    dom.pullToRefreshIndicator.style.opacity = 0;
                }
                state.touchStartY = 0;
            };

            // --- EVENT LISTENERS ---
            const addEventListeners = () => {
                dom.tabVisitor.addEventListener('click', () => switchTab('visitor'));
                dom.tabCommunity.addEventListener('click', () => switchTab('community'));
                dom.searchBar.addEventListener('input', handleSearch);
                dom.quickActionItems.forEach(item => item.addEventListener('click', (e) => {
                    const action = e.currentTarget.dataset.action;
                    if (action === 'helpdesk') openModal('helpdesk-modal');
                    if (action === 'entries') openModal('entries-modal');
                    if (action === 'scan') openModal('qr-modal');
                    if (action === 'services') openModal('services-modal');
                    if (action === 'sos') openModal('sos-modal');
                    if (action === 'clubhouse') openModal('clubhouse-modal');
                    if (action === 'delivery') openModal('delivery-modal');
                }));
                dom.modalCloseBtns.forEach(btn => btn.addEventListener('click', () => closeModal(btn.dataset.modal)));
                document.querySelectorAll('[id$="-modal"]').forEach(modal => modal.addEventListener('click', (e) => {
                    if (e.target === modal) closeModal(modal.id);
                }));
                dom.visitorContent.addEventListener('click', openDetailView);
                dom.communityContent.addEventListener('click', openDetailView);
                dom.detailBackBtn.addEventListener('click', () => dom.detailView.classList.remove('show'));
                dom.communityContent.addEventListener('click', (e) => {
                    const toggleBtn = e.target.closest('[data-action="toggle-comments"]');
                    if (toggleBtn) {
                        const postCard = toggleBtn.closest('.bg-white');
                        const commentsSection = postCard.querySelector('.comments-section');
                        commentsSection.classList.toggle('hidden');
                    }
                });                dom.darkModeToggle.addEventListener('click', toggleDarkMode);
                dom.profileDrawerBtn.addEventListener('click', openDrawer);
                dom.profileDrawerCloseBtn.addEventListener('click', closeDrawer);
                dom.drawerOverlay.addEventListener('click', closeDrawer);
                dom.appContainer.addEventListener('touchstart', handleTouchStart, { passive: false });
                dom.appContainer.addEventListener('touchmove', handleTouchMove, { passive: false });
                dom.appContainer.addEventListener('touchend', handleTouchEnd);
                dom.navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        navigateTo(link.dataset.page);
                    });
                });
                dom.confirmSosBtn.addEventListener('click', () => {
                    const sosConfirmation = document.getElementById('sos-confirmation-content');
                    const sosSent = document.getElementById('sos-sent-content');
                    sosConfirmation.classList.add('hidden');
                    sosSent.classList.remove('hidden');
                });
                // Reset SOS modal when closed
                document.getElementById('sos-modal').addEventListener('click', (e) => {
                    if (e.target.id === 'sos-modal' || e.target.closest('.modal-close-btn')) {
                        setTimeout(() => {
                            document.getElementById('sos-confirmation-content').classList.remove('hidden');
                            document.getElementById('sos-sent-content').classList.add('hidden');
                        }, 300); // Delay to allow closing animation
                    }
                });
                // Clubhouse booking logic
                dom.clubhouseModal.addEventListener('click', (e) => {
                    if (e.target.closest('.book-amenity-btn')) {
                        document.getElementById('clubhouse-booking-content').classList.add('hidden');
                        document.getElementById('clubhouse-booked-content').classList.remove('hidden');
                    }
                });
                // Reset Clubhouse modal when closed
                dom.clubhouseModal.addEventListener('click', (e) => {
                    if (e.target.id === 'clubhouse-modal' || e.target.closest('.modal-close-btn')) {
                        setTimeout(() => {
                            document.getElementById('clubhouse-booking-content').classList.remove('hidden');
                            document.getElementById('clubhouse-booked-content').classList.add('hidden');
                        }, 300); // Delay to allow closing animation
                    }
                });
                // Delivery approval logic
                document.getElementById('delivery-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    document.getElementById('delivery-form-content').classList.add('hidden');
                    document.getElementById('delivery-approved-content').classList.remove('hidden');
                });
                // Reset Delivery modal when closed
                dom.deliveryModal.addEventListener('click', (e) => {
                    if (e.target.id === 'delivery-modal' || e.target.closest('.modal-close-btn')) {
                        setTimeout(() => {
                            document.getElementById('delivery-form-content').classList.remove('hidden');
                            document.getElementById('delivery-approved-content').classList.add('hidden');
                            document.getElementById('delivery-form').reset();
                        }, 300); // Delay to allow closing animation
                    }
                });

                // Payment filter buttons
                dom.paymentFilterBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        dom.paymentFilterBtns.forEach(b => b.classList.remove('bg-blue-500', 'text-white', 'dark:bg-blue-500'));
                        btn.classList.add('bg-blue-500', 'text-white', 'dark:bg-blue-500');
                        renderPayments(btn.dataset.filter);
                    });
                });


                // Marketplace category filtering
                document.querySelectorAll('.marketplace-category').forEach(categoryEl => {
                    categoryEl.addEventListener('click', () => renderMarketplace(categoryEl.dataset.category));
                });

                // Set initial active category to 'all' on marketplace page load
                const marketplaceNavLink = document.querySelector('.nav-link[data-page="marketplace"]');
                if (marketplaceNavLink) {
                    marketplaceNavLink.addEventListener('click', () => renderMarketplace('all'));
                }

                // Marketplace favorite button
                dom.marketplaceContent.addEventListener('click', (e) => {
                    const favBtn = e.target.closest('.favorite-btn');
                    if (favBtn) {
                        favBtn.classList.toggle('favorited');
                        favBtn.querySelector('.ph-heart').classList.toggle('hidden');
                        favBtn.querySelector('.ph-heart-fill').classList.toggle('hidden');
                    }
                });
            };

            // --- INITIALIZATION ---
            initDarkMode();
            addEventListeners();
            loadContent();
        });
    </script>

</body>
</html>
